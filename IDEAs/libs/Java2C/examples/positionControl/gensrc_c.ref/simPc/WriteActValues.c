/**************************************************************************
 * This file is generated by Java2C
 **copyright***************************************************************
 *************************************************************************/
#include "simPc/WriteActValues.h"
#include <string.h>  //because using memset()
#include <Jc/ReflectionJc.h>   //Reflection concept 
#include <Fwc/fw_Exception.h>  //basic stacktrace concept
#include "Jc/FileIOJc.h"  //reference-association: FileSystemJc


const char sign_Mtbl_WriteActValues[] = "WriteActValues"; //to mark method tables of all implementations

typedef struct MtblDef_WriteActValues_t { Mtbl_WriteActValues mtbl; MtblHeadJc end; } MtblDef_WriteActValues;
 extern MtblDef_WriteActValues const mtblWriteActValues;

/*Constructor */
struct WriteActValues_t* ctorO_WriteActValues(ObjectJc* othis, ThCxt* _thCxt)
{ WriteActValues_s* ythis = (WriteActValues_s*)othis;  //upcasting to the real class.
  STACKTRC_TENTRY("ctorO_WriteActValues");
  checkConsistence_ObjectJc(othis, sizeof(WriteActValues_s), null, _thCxt);  
  setReflection_ObjectJc(othis, &reflection_WriteActValues_s, sizeof(WriteActValues_s));  
  //j2c: Initialize all class variables:
  {
    //J2C: constructor for embedded element-ObjectJc
      init_ObjectJc(&(ythis->fileActValues.base.object), sizeof(ythis->fileActValues), 0); 
      ctorO_FileJc(/*static*/&(ythis->fileActValues.base.object), s0_StringJc("out/actValues.bin"), _thCxt);
    /*J2C: newArray*/
      init_ObjectJc(&ythis->valueBuffer.head.object, sizeof_ARRAYJc(int8, 400), 0);   //J2C: ctor embedded array.
      ctorO_ObjectArrayJc(&ythis->valueBuffer.head.object, 400, sizeof(int8), null, 0);//J2C: constructor for embedded array;
    //J2C: constructor for embedded element-ObjectJc
      init_ObjectJc(&(ythis->actValueOut.base.object), sizeof(ythis->actValueOut), 0); 
      ctorO_RawDataAccessJc(/*static*/&(ythis->actValueOut.base.object), _thCxt);
  }
  { 
    
    setBigEndian_b_RawDataAccessJc_F(& ((ythis->actValueOut).base.super), true, _thCxt);
    assignEmpty_ByteDataAccessJc(& ((ythis->actValueOut).base.super), (struct int8_Y_t*)(&( ythis->valueBuffer)), _thCxt);
  }
  STACKTRC_LEAVE;
  return ythis;
}


void write_WriteActValues_F(WriteActValues_s* ythis, float way, float current, ThCxt* _thCxt)
{ 
  STACKTRC_TENTRY("write_WriteActValues_F");
  
  { 
    
    ASSERT(/*static*/ythis->ix - recordsize_WriteActValues < ythis->valueBuffer.head.length);
    setFloatVal_RawDataAccessJc(& (ythis->actValueOut), ythis->ix, way, _thCxt);
    setFloatVal_RawDataAccessJc(& (ythis->actValueOut), ythis->ix + 4, current, _thCxt);
    ythis->ix += recordsize_WriteActValues;
    if(ythis->ix + recordsize_WriteActValues >= ythis->valueBuffer.head.length) 
    { 
      
      /**The next entry will be force overflow:*/
      writeBinFile_FileSystemJc(/*static*/& (ythis->fileActValues), (struct int8_Y_t*)(&( ythis->valueBuffer)), _thCxt);
      ythis->ix = 0;
    }
  }
  STACKTRC_LEAVE;
}

/*J2C: dynamic call variant of the override-able method: */
void write_WriteActValues(WriteActValues_s* ythis, float way, float current, ThCxt* _thCxt)
{ Mtbl_WriteActValues const* mtbl = (Mtbl_WriteActValues const*)getMtbl_ObjectJc(&ythis->base.object, sign_Mtbl_WriteActValues);
  mtbl->write(ythis, way, current, _thCxt);
}



/**J2C: Reflections and Method-table *************************************************/
const MtblDef_WriteActValues mtblWriteActValues = {
{ { sign_Mtbl_WriteActValues//J2C: Head of methodtable.
  , (struct Size_Mtbl_t*)((1 +2) * sizeof(void*)) //size. NOTE: all elements are standard-pointer-types.
  }
, write_WriteActValues_F //write
, { { sign_Mtbl_ObjectJc//J2C: Head of methodtable.
    , (struct Size_Mtbl_t*)((5 +2) * sizeof(void*)) //size. NOTE: all elements are standard-pointer-types.
    }
  , clone_ObjectJc_F //clone
  , equals_ObjectJc_F //equals
  , finalize_ObjectJc_F //finalize
  , hashCode_ObjectJc_F //hashCode
  , toString_ObjectJc_F //toString
  }
}, { signEnd_Mtbl_ObjectJc, null } }; //Mtbl


 extern struct ClassJc_t const reflection_ObjectJc;
 static struct superClasses_WriteActValues_s_t
 { ObjectArrayJc head;
   ClassOffset_idxMtblJc data[1];
 }superclasses_WriteActValues_s =
 { CONST_ObjectArrayJc(ClassOffset_idxMtblJc, 1, OBJTYPE_ClassOffset_idxMtblJc, null, null)
 , { {&reflection_ObjectJc, OFFSET_Mtbl(Mtbl_WriteActValues, ObjectJc) }
   }
 };

extern struct ClassJc_t const reflection_WriteActValues_s;
extern struct ClassJc_t const reflection_FileJc_s;
extern struct ClassJc_t const reflection_RawDataAccessJc_s;
const struct Reflection_Fields_WriteActValues_s_t
{ ObjectArrayJc head; FieldJc data[4];
} reflection_Fields_WriteActValues_s =
{ CONST_ObjectArrayJc(FieldJc, 4, OBJTYPE_FieldJc, null, &reflection_Fields_WriteActValues_s)
, {
     { "fileActValues"
    , 0 //nrofArrayElements
    , &reflection_FileJc_s
    , kEmbedded_Modifier_reflectJc |mObjectJc_Modifier_reflectJc //bitModifiers
    , (int16)((int32)(&((WriteActValues_s*)(0x1000))->fileActValues) - (int32)(WriteActValues_s*)0x1000)
    , 0  //offsetToObjectifcBase
    , &reflection_WriteActValues_s
    }
   , { "valueBuffer"
    , 400 //nrofArrayElements
    , REFLECTION_int8
    , 1 << kBitPrimitiv_Modifier_reflectJc |kStaticArray_Modifier_reflectJc |kEmbeddedContainer_Modifier_reflectJc //bitModifiers
    , (int16)((int32)(&((WriteActValues_s*)(0x1000))->valueBuffer) - (int32)(WriteActValues_s*)0x1000)
    , 0  //offsetToObjectifcBase
    , &reflection_WriteActValues_s
    }
   , { "actValueOut"
    , 0 //nrofArrayElements
    , &reflection_RawDataAccessJc_s
    , kEmbedded_Modifier_reflectJc //bitModifiers
    , (int16)((int32)(&((WriteActValues_s*)(0x1000))->actValueOut) - (int32)(WriteActValues_s*)0x1000)
    , 0  //offsetToObjectifcBase
    , &reflection_WriteActValues_s
    }
   , { "ix"
    , 0 //nrofArrayElements
    , REFLECTION_int32
    , 4 << kBitPrimitiv_Modifier_reflectJc //bitModifiers
    , (int16)((int32)(&((WriteActValues_s*)(0x1000))->ix) - (int32)(WriteActValues_s*)0x1000)
    , 0  //offsetToObjectifcBase
    , &reflection_WriteActValues_s
    }
} };
const ClassJc reflection_WriteActValues_s = 
{ CONST_ObjectJc(OBJTYPE_ClassJc + sizeof(ClassJc), &reflection_ObjectJc, &reflection_ClassJc) 
, "WriteActValues_s"
,  0 //position of ObjectJc
, sizeof(WriteActValues_s)
, (FieldJcArray const*)&reflection_Fields_WriteActValues_s
, null //method
, (ClassOffset_idxMtblJcARRAY*)&superclasses_WriteActValues_s //superclass
, null //interfaces
, 0    //modifiers
, &mtblWriteActValues.mtbl.head
};
